<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui" 
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <f:metadata>
        <f:event type="preRenderView" listener="#{redirection.redirectUserIfLoggedIn()}"/>
    </f:metadata>

    <h:head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="#{request.contextPath}/resources/css/bootstrap.min.css" />
        <link rel="stylesheet" href="#{request.contextPath}/resources/css/page-default.css" />
        <title>ClientBase - Login</title>
    </h:head>

    <h:body class="login-bg" style="background: url('#{request.contextPath}/resources/imgs/bg.png') center no-repeat;">
        <div class="page-content container">
            <div class="row">

                <div class="col-sm-6 col-sm-offset-3 col-xs-12">
                    <div class="login-wrapper">
                        <div class="box">
                            <div class="content-wrap">

                                <img src="#{request.contextPath}/resources/imgs/logo-big.png" alt="ClientBase" width="200" />

                                <h6>Sign In</h6>

                                <form role="form" class="form-horizontal" method="POST" action="j_security_check" onkeypress="if (event.keyCode === 13) {
                                            document.getElementById('loginButton').click();
                                            return false;
                                        }"> 

                                    <div class="form-group row" >
                                        <label class="control-label col-sm-4" for="j_username">Email address:</label>
                                        <div class="col-sm-8">
                                            <p:inputText id="j_username"  required="true" requiredMessage="Please enter your email address"  />
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <label class="control-label col-sm-4" for="j_password">Password:</label>
                                        <div class="col-sm-8">
                                            <p:password id="j_password"  required="true" requiredMessage="Please enter your password" />
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <button id="submitButton" type="submit" value="login" class="btn btn-info btn-lg">Login</button> 
                                        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#reg_modal"  >Sign Up</button>
                                    </div>
                                </form>

                                <div class="modal fade" id="reg_modal" role="dialog">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <button type="button" class="close" data-dismiss="modal"></button>
                                                <h6 class="modal-title">Registration</h6>
                                            </div>
                                            <div class="modal-body">
                                                <h:form id="registerForm" role="form" class="form-horizontal">
                                                    
                                                    <div class="form-group row" >
                                                        <label class="control-label col-sm-4" for="firstName">First name:</label>
                                                        <div class="col-sm-8">
                                                            <p:inputText id="firstName" value="#{user.firstName}"  size="40" label="firstName" placeholder="Enter your first name ( min. 2 caracters )"
                                                                         required="true" requiredMessage="Please enter your first name" />
                                                        </div>
                                                    </div>

                                                    <div class="form-group row" >
                                                        <label class="control-label col-sm-4" for="lastName">Last name:</label>
                                                        <div class="col-sm-8">
                                                            <p:inputText id="lastName" value="#{user.lastName}"  size="40" label="lastName" placeholder="Enter your last name ( min. 2 caracters )"
                                                                         required="true" requiredMessage="Please enter your last name" />
                                                        </div>
                                                    </div>

                                                    <div class="form-group row" >
                                                        <label class="control-label col-sm-4" for="firstName">Email address:</label>
                                                        <div class="col-sm-8">
                                                            <p:inputText id="email" required="true" label="email"  size="40" placeholder="Enter your email address"
                                                                         requiredMessage="Please enter your email address."
                                                                         validatorMessage="Invalid email format"                             
                                                                         value="#{user.email}">
                                                                <f:validateRegex
                                                                    pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
                                                            </p:inputText>  
                                                        </div>
                                                    </div>

                                                    <div class="form-group row" >
                                                        <label class="control-label col-sm-4" for="password">Password:</label>
                                                        <div class="col-sm-8">
                                                            <p:password id="password" value="#{user.password}"   size="40" label="password" placeholder="Enter your password ( min. 6 caracters)"
                                                                        required="true" requiredMessage="Please enter your password" /> 
                                                        </div>
                                                    </div>

                                                    <div class="form-group row" >
                                                        <label class="control-label col-sm-4" for="confirmPassword">Password again:</label>
                                                        <div class="col-sm-8">
                                                            <p:password id="confirmPassword" value="#{user.confirmPassword}"  size="40" placeholder="Enter your password again ( min. 6 caracters)" />        
                                                        </div>
                                                    </div>

                                                    <div class="form-group row" >
                                                        <p:commandButton update="reg" type="button" onclick="rc()" validateClient="true" value="Create account" class="btn btn-info btn-default"  />
                                                    </div>

                                                    <p:remoteCommand name="rc" update="msgs" actionListener="#{user.register}"  />
                                                    <p:growl id="msgs" showDetail="true" class="z"/>

                                                </h:form> 
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                                            </div>
                                        </div>

                                    </div>
                                </div>
                            </div>    
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="#{request.contextPath}/resources/js/jquery.min.js"></script>
        <script src="#{request.contextPath}/resources/js/bootstrap.min.js"></script>
    </h:body>
</html>